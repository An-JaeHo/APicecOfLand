using System.Collections;
using System.Collections.Generic;
using UnityEngine;
using UnityEngine.UI;

public class TutorialTalkManger : MonoBehaviour
{
    [Header("Set in Inspector")]
    public GameObject settingButton;
    public Text spcriptText;
    public TutorialTileManger tile;
    public TutorialInputManger inputManger;
    public GameObject dimmedCover;

    [Header("Build Tutorial Obj")]
    public GameObject outPutUi;
    public GameObject consumeUi;
    public GameObject areaUi;

    [Header("Set in ViualStudio")]
    public int spcriptNum;
    public int textNum;
    public bool sceneCheck;
    public bool talkCheck;
    public int stopTalkNum;
    public PlayerInfo player;
    public SaveMgr save;
    public bool firstTalk;

    public bool buildCheck;
    public bool barrackCheck;


    private List< string> scripts;

    void Start()
    {
        spcriptNum = 0;
        stopTalkNum = 999;
        scripts = new List<string>();
        textNum = 4;
        scripts.Add("스크립트 1-1");
        scripts.Add("스크립트 1-2");
        scripts.Add("스크립트 1-3");
        scripts.Add("스크립트 1-4");
        tile.StartTile();
        sceneCheck = false;
        spcriptText.text = scripts[spcriptNum];
        talkCheck = false;
        player = GameObject.FindGameObjectWithTag("GameManger").GetComponent<PlayerInfo>();
        save = GameObject.FindGameObjectWithTag("GameManger").GetComponent<SaveMgr>();
    }

    public void NextScriptButton()
    {
        Debug.Log(stopTalkNum);
        Debug.Log(spcriptNum);
        if (spcriptNum!= stopTalkNum)
        {
            spcriptNum++;

            if (spcriptNum < textNum)
            {
                spcriptText.text = scripts[spcriptNum];
            }
            else
            {
                inputManger.talk = false;

                if (firstTalk)
                {
                    if (spcriptNum == 4)
                    {
                        BulidTalk();
                        firstTalk = false;
                    }
                }

                if (sceneCheck)
                {
                    player.ResetGame();
                    save.Save();
                    SceneMgr.GoUpGradeScene();
                }
            }
        }
    }

    public void BulidTalk()
    {
        scripts.Clear();
        buildCheck = true;
        textNum = 5;
        dimmedCover.SetActive(true);
        tile.tutorialLand.transform.GetChild(0).GetComponent<SpriteRenderer>().sortingOrder = 1002;
        spcriptNum = 0;
        stopTalkNum = 0;
        scripts.Add("스크립트 2-1");
        scripts.Add("스크립트 2-2");
        scripts.Add("스크립트 2-3");
        scripts.Add("스크립트 2-4");
        scripts.Add("스크립트 2-5");
        spcriptText.text = scripts[spcriptNum];
    }

    public void BarrackTalk()
    {
        inputManger.talk = true;
        scripts.Clear();
        textNum = 4;
        spcriptNum = 0;
        scripts.Add("자 아까와 비슷하지?");
        scripts.Add("이번에는 저 대담하고 큰 초코칩쿠키를 눌러보자");
        scripts.Add("이번에도 왼쪽에 초코칩쿠키가 나왔어");
        scripts.Add("생산버튼을 눌러서 초코칩쿠키를 부르자");
        
        spcriptText.text = scripts[spcriptNum];
    }

    public void MoveTalk()
    {
        //inputManger.talk = true;
        scripts.Clear();
        textNum = 5;
        spcriptNum = 0;
        scripts.Add("와 드디어 친구를 불렀어!");
        scripts.Add("이번에는 초코칩쿠키를 눌러볼까?");
        scripts.Add("누르니깐 바닥에 색이 달라졌네?");
        scripts.Add("저건 쿠키들이 이동할 수 있는 범위를 나타낸거야 ");
        scripts.Add("어서 눌러보자");
        spcriptText.text = scripts[spcriptNum];
    }

    public void NextTalk()
    {
        inputManger.talk = true;
        scripts.Clear();
        textNum = 6;
        spcriptNum = 0;
        scripts.Add("이런 쥐들이 와버렸어");
        scripts.Add("어서 공격해서 쫓아내버리자");
        scripts.Add("아까랑 같이 초코칩쿠키를 눌러보자");
        scripts.Add("이번에는 색이 변했어");
        scripts.Add("이건 공격할수 있는 범위를 보여주는 거야");
        scripts.Add("어서 눌러서 쥐를 몰아내자");
        spcriptText.text = scripts[spcriptNum];
    }

    public void FinalTalk()
    {
        inputManger.talk = true;
        scripts.Clear();
        textNum = 7;
        spcriptNum = 0;
        scripts.Add("자 이제 저 우주선을 파괴하자");
        scripts.Add("그렇지 않으면 또 쥐가 나올꺼야");
        scripts.Add("우주선 위로 올라간다면 파괴할수 있을꺼야");
        scripts.Add("어서 움직이자");
        scripts.Add("잘했어! 우리가 쥐를 물리쳤어!");
        scripts.Add("곧 쥐들이 다시 올꺼야");
        scripts.Add("이제 다음공격에 대비해 준비를 하자");
        spcriptText.text = scripts[spcriptNum];
        sceneCheck = true;
    }
}
